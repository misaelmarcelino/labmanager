import{a as F}from"./chunk-77VMSZOX.js";import{a as A}from"./chunk-KQ3Y33YD.js";import{a as V}from"./chunk-SROPCUAA.js";import{g as w}from"./chunk-APFEB53J.js";import{l as M,m as T,q as k}from"./chunk-K6RXEC2N.js";import{$a as v,La as u,Na as m,Pa as n,Qa as s,Ra as b,Ua as x,Xa as g,Ya as l,Za as S,_ as U,_a as o,a as h,ab as C,b as E,fb as y,ha as p,ia as _,jb as I,wa as a,xa as f}from"./chunk-TBSY5OFZ.js";function R(t,c){if(t&1&&(n(0,"div",10),o(1),s()),t&2){let e=l();a(),C(" ",e.errorMessage," ")}}function j(t,c){if(t&1){let e=x();n(0,"div",11)(1,"button",12),g("click",function(){p(e);let r=l();return _(r.openCreateUserModal())}),b(2,"i",13),o(3," Novo Usu\xE1rio "),s()()}}function N(t,c){t&1&&(n(0,"span",18),o(1,"Admin"),s())}function D(t,c){t&1&&(n(0,"span",19),o(1,"User"),s())}function z(t,c){if(t&1){let e=x();n(0,"button",20),g("click",function(){p(e);let r=l().$implicit,d=l();return _(d.confirmDelete(r.id))}),b(1,"i",21),o(2," Excluir "),s()}}function O(t,c){if(t&1){let e=x();n(0,"button",22),g("click",function(){p(e);let r=l().$implicit,d=l();return _(d.editUser(r))}),b(1,"i",23),o(2," Editar "),s()}}function $(t,c){if(t&1&&(n(0,"tr",8)(1,"td"),o(2),s(),n(3,"td"),o(4),s(),n(5,"td"),o(6),s(),n(7,"td"),u(8,N,2,0,"span",14)(9,D,2,0,"ng-template",null,0,I),s(),n(11,"td")(12,"div",15),u(13,z,3,0,"button",16)(14,O,3,0,"button",17),s()()()),t&2){let e=c.$implicit,i=S(10),r=l();a(2),v(e.id),a(2),v(e.name),a(2),v(e.email),a(2),m("ngIf",e.role.toLowerCase()==="admin")("ngIfElse",i),a(5),m("ngIf",r.isAdmin()),a(),m("ngIf",r.isAdmin())}}var K=(()=>{class t{constructor(e,i,r){this.auth=e,this.usersService=i,this.modalService=r,this.users=[],this.errorMessage=null,this.userRole=null}ngOnInit(){let e=this.auth.user;this.userRole=e?e.role:null,this.loadUsers()}loadUsers(){this.usersService.listAll().subscribe({next:e=>this.users=e,error:e=>{console.error("Erro ao buscar usu\xE1rios:",e),this.errorMessage="N\xE3o foi poss\xEDvel carregar usu\xE1rios."}})}openCreateUserModal(){this.modalService.open({title:"Novo Usu\xE1rio",type:"form",entityType:"user",data:{},onConfirm:e=>this.createUser(e)})}createUser(e){let i=E(h({},e),{role:e.role?.toUpperCase()||"USER"});this.usersService.create(i).subscribe({next:r=>{console.log("\u2705 Usu\xE1rio criado:",r),this.loadUsers(),this.modalService.open({title:"Sucesso!",message:"Usu\xE1rio cadastrado com sucesso!",type:"info"})},error:r=>{console.error("Erro ao salvar usu\xE1rio:",r),this.errorMessage="Erro ao salvar usu\xE1rio."}})}editUser(e){this.modalService.open({title:"Editar Usu\xE1rio",type:"form",entityType:"user",data:e,onConfirm:i=>this.updateUser(e.id,i)})}updateUser(e,i){let r=E(h({},i),{role:i.role?.toUpperCase()||"USER"});this.usersService.update(e,r).subscribe({next:()=>{console.log(`Usu\xE1rio ${e} atualizado.`),this.loadUsers()},error:d=>{console.error("Erro ao atualizar usu\xE1rio:",d),this.errorMessage="Erro ao atualizar usu\xE1rio."}})}confirmDelete(e){this.modalService.open({title:"Excluir Usu\xE1rio",message:"Tem certeza que deseja excluir este usu\xE1rio?",type:"confirm",onConfirm:()=>this.deleteUser(e)})}deleteUser(e){this.usersService.delete(e).subscribe({next:()=>this.loadUsers(),error:i=>{console.error("Erro ao excluir usu\xE1rio:",i),this.errorMessage="Erro ao excluir usu\xE1rio."}})}isAdmin(){return this.userRole?.toLowerCase()==="admin"}static{this.\u0275fac=function(i){return new(i||t)(f(V),f(F),f(A))}}static{this.\u0275cmp=U({type:t,selectors:[["app-users"]],standalone:!0,features:[y],decls:22,vars:3,consts:[["notAdmin",""],[1,"section-content","container","mt-4"],["class","alert alert-danger",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],["class","mb-3",4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],[1,"table-dark"],[1,"text-center"],["class","text-center",4,"ngFor","ngForOf"],[1,"alert","alert-danger"],[1,"mb-3"],[1,"btn","btn-success",3,"click"],[1,"bi","bi-person-plus"],["class","badge bg-primary",4,"ngIf","ngIfElse"],[1,"d-flex","gap-2","align-items-center","justify-content-center"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],[1,"badge","bg-primary"],[1,"badge","bg-secondary"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash3"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"bi","bi-pencil"]],template:function(i,r){i&1&&(n(0,"section",1),u(1,R,2,1,"div",2),n(2,"div",3)(3,"h2"),o(4,"Gest\xE3o de Usu\xE1rios"),s(),u(5,j,4,0,"div",4),s(),n(6,"div",5)(7,"table",6)(8,"thead",7)(9,"tr",8)(10,"th"),o(11,"ID"),s(),n(12,"th"),o(13,"Nome"),s(),n(14,"th"),o(15,"Email"),s(),n(16,"th"),o(17,"Permiss\xE3o"),s(),n(18,"th"),o(19,"A\xE7\xF5es"),s()()(),n(20,"tbody"),u(21,$,15,7,"tr",9),s()()()()),i&2&&(a(),m("ngIf",r.errorMessage),a(4),m("ngIf",r.isAdmin()),a(16),m("ngForOf",r.users))},dependencies:[k,M,T,w]})}}return t})();export{K as a};
