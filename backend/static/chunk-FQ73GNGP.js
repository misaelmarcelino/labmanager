import{d as c}from"./chunk-XU55PKE2.js";import{Ba as u,K as o,Lb as l,N as n,S as i,p as a}from"./chunk-KKA7MAXA.js";var w=(()=>{class r{get user(){return this._user()}get isLoggedIn(){return!!this._user()}constructor(e,t){this.api=e,this.router=t,this._user=u(null)}login(e,t){return this.api.post("auth/login",{email:e,password:t}).pipe(o(s=>{localStorage.setItem("auth_token",s.access_token);let h={email:s.email,name:s.name,role:s.role,is_first_access:s.is_first_access};sessionStorage.setItem("old_password",t),this._user.set(h)}),a(s=>({email:s.email,name:s.name,role:s.role,is_first_access:s.is_first_access})))}logout(){this._user.set(null),localStorage.removeItem("auth_token"),this.router.navigate(["/login"])}hasRole(e){let t=this._user();return t?t.role===e:!1}requestPasswordReset(e){return this.api.post("auth/forgot-password",{email:e})}resetPassword(e,t){return this.api.post("auth/reset-password/confirm",{token:e,new_password:t})}changePassword(e,t){return this.api.put("auth/change-password",{old_password:e,new_password:t})}static{this.\u0275fac=function(t){return new(t||r)(i(l),i(c))}}static{this.\u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{w as a};
