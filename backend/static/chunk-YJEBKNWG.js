import{d as u}from"./chunk-CMUAIOSF.js";import{Ba as n,K as o,Lb as l,N as c,S as i,p as a}from"./chunk-LOHWPVPR.js";var w=(()=>{class r{get user(){return this._user()}get isLoggedIn(){return!!this._user()}constructor(t,s){this.api=t,this.router=s,this._user=n(null)}login(t,s){return this.api.post("auth/login",{email:t,password:s}).pipe(o(e=>{localStorage.setItem("auth_token",e.access_token);let m={email:e.email,name:e.name,role:e.role,is_first_access:e.is_first_access};this._user.set(m)}),a(e=>({email:e.email,name:e.name,role:e.role,is_first_access:e.is_first_access})))}logout(){this._user.set(null),localStorage.removeItem("auth_token"),this.router.navigate(["/login"])}hasRole(t){let s=this._user();return s?s.role===t:!1}requestPasswordReset(t){return this.api.post("auth/forgot-password",{email:t})}resetPassword(t,s){return this.api.post("auth/reset-password/confirm",{token:t,new_password:s})}firstAccess(t,s,e){return this.api.post("auth/first-access",{email:t,temp_password:s,new_password:e})}static{this.\u0275fac=function(s){return new(s||r)(i(l),i(u))}}static{this.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{w as a};
