import{d as l}from"./chunk-APFEB53J.js";import{x as m}from"./chunk-K6RXEC2N.js";import{Fa as u,L as a,P as n,U as o,q as s}from"./chunk-TBSY5OFZ.js";var w=(()=>{class i{get user(){return this._user()}get isLoggedIn(){return!!this._user()}constructor(t,e){this.api=t,this.router=e,this._user=u(null)}login(t,e){return this.api.post("auth/login",{email:t,password:e}).pipe(a(r=>{localStorage.setItem("auth_token",r.access_token);let c={email:r.email,name:r.name,role:r.role};this._user.set(c)}),s(r=>({email:r.email,name:r.name,role:r.role})))}logout(){this._user.set(null),localStorage.removeItem("auth_token"),this.router.navigate(["/login"])}hasRole(t){let e=this._user();return e?e.role===t:!1}requestPasswordReset(t){return this.api.post("auth/forgot-password",{email:t})}resetPassword(t,e){return this.api.post("auth/reset-password",{token:t,new_password:e})}static{this.\u0275fac=function(e){return new(e||i)(o(m),o(l))}}static{this.\u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{w as a};
