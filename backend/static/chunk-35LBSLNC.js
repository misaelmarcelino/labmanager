import{a as F}from"./chunk-6E4SWIPS.js";import{a as D}from"./chunk-KQ3Y33YD.js";import{a as A}from"./chunk-SROPCUAA.js";import{l as w,m as k,p as R,q as V}from"./chunk-K6RXEC2N.js";import{$a as l,La as c,Na as d,Pa as n,Qa as i,Ra as C,Ua as v,Xa as f,Ya as m,Za as g,_ as b,_a as o,a as h,ab as I,b as S,fb as y,ha as _,hb as M,ia as E,ib as T,jb as q,wa as r,xa as x}from"./chunk-TBSY5OFZ.js";function O(t,p){if(t&1&&(n(0,"div",11),o(1),i()),t&2){let e=m();r(),I(" ",e.errorMessage," ")}}function P(t,p){t&1&&(n(0,"th",17),o(1,"A\xE7\xF5es"),i())}function $(t,p){if(t&1&&(n(0,"span",19),o(1),i()),t&2){let e=m().$implicit;r(),l(e.status)}}function N(t,p){if(t&1&&(n(0,"span",21),o(1),i()),t&2){let e=m(2).$implicit;r(),l(e.status)}}function j(t,p){if(t&1&&(n(0,"span",22),o(1),i()),t&2){let e=m(2).$implicit;r(),l(e.status)}}function z(t,p){if(t&1&&c(0,N,2,1,"span",20)(1,j,2,1,"ng-template",null,2,q),t&2){let e=g(2),a=m().$implicit;d("ngIf",a.status==="REPROVADO")("ngIfElse",e)}}function L(t,p){if(t&1){let e=v();n(0,"td",17)(1,"button",23),f("click",function(){_(e);let s=m().$implicit,u=m(2);return E(u.confirmDelete(s.id))}),o(2,"Excluir"),i(),n(3,"button",24),f("click",function(){_(e);let s=m().$implicit,u=m(2);return E(u.editEquipment(s))}),o(4,"Editar"),i()()}}function B(t,p){if(t&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),i(),n(11,"td"),o(12),M(13,"date"),i(),n(14,"td"),o(15),i(),n(16,"td"),c(17,$,2,1,"span",18)(18,z,3,2,"ng-template",null,1,q),i(),c(20,L,5,0,"td",15),i()),t&2){let e=p.$implicit,a=g(19),s=m(2);r(2),l(e.codigo),r(2),l(e.nome_do_posto),r(2),l(e.razao_uso||"-"),r(2),l(e.versao_solucao),r(2),l(e.descricao),r(2),l(e.data_limite?T(13,10,e.data_limite,"dd/MM/yyyy"):"-"),r(3),l(e.responsavel),r(2),d("ngIf",e.status==="APROVADO")("ngIfElse",a),r(3),d("ngIf",s.isAdmin())}}function H(t,p){if(t&1&&(n(0,"div")(1,"div",12)(2,"table",13)(3,"thead",14)(4,"tr")(5,"th"),o(6,"C\xF3digo"),i(),n(7,"th"),o(8,"Posto"),i(),n(9,"th"),o(10,"Raz\xE3o de Uso"),i(),n(11,"th"),o(12,"Vers\xE3o"),i(),n(13,"th"),o(14,"Motivo"),i(),n(15,"th"),o(16,"Data Limite"),i(),n(17,"th"),o(18,"Respons\xE1vel"),i(),n(19,"th"),o(20,"Status"),i(),c(21,P,2,0,"th",15),i()(),n(22,"tbody"),c(23,B,21,13,"tr",16),i()()()()),t&2){let e=m();r(21),d("ngIf",e.isAdmin()),r(2),d("ngForOf",e.equipamentos)}}function U(t,p){t&1&&(n(0,"div",25),o(1," Nenhum equipamento cadastrado at\xE9 o momento. "),i())}var ee=(()=>{class t{constructor(e,a,s){this.auth=e,this.equipmentService=a,this.modalService=s,this.equipamentos=[],this.errorMessage=null,this.userRole=null}ngOnInit(){let e=this.auth.user;this.userRole=e?e.role:null,this.loadEquipamentos()}loadEquipamentos(){this.equipmentService.listAll().subscribe({next:e=>this.equipamentos=e,error:e=>{console.error("Erro ao buscar equipamentos:",e),this.errorMessage="N\xE3o foi poss\xEDvel carregar equipamentos."}})}openCreateEquipmentModal(){this.modalService.open({title:"Novo Equipamento",type:"form",entityType:"equipment",data:{},onConfirm:e=>this.createEquipment(e)})}createEquipment(e){let a=S(h({},e),{status:e.status||"Pendente"});this.equipmentService.create(a).subscribe({next:()=>{this.loadEquipamentos(),this.modalService.open({title:"Sucesso!",message:"Equipamento cadastrado com sucesso!",type:"info"})},error:s=>{console.error("Erro ao criar equipamento:",s),this.errorMessage="Erro ao criar equipamento."}})}editEquipment(e){this.modalService.open({title:"Editar Equipamento",type:"form",entityType:"equipment",data:e,onConfirm:a=>this.updateEquipment(e.id,a)})}updateEquipment(e,a){this.equipmentService.update(e,a).subscribe({next:()=>{this.loadEquipamentos(),this.modalService.open({title:"Sucesso!",message:"Equipamento atualizado com sucesso!",type:"info"})},error:s=>{console.error("Erro ao atualizar equipamento:",s),this.errorMessage="Erro ao atualizar equipamento."}})}confirmDelete(e){this.modalService.open({title:"Excluir Equipamento",message:"Deseja realmente excluir este equipamento?",type:"confirm",onConfirm:()=>this.deleteEquipment(e)})}deleteEquipment(e){this.equipmentService.delete(e).subscribe({next:()=>this.loadEquipamentos(),error:a=>{console.error("Erro ao excluir equipamento:",a),this.errorMessage="Erro ao excluir equipamento."}})}isAdmin(){return this.userRole?.toLowerCase()==="admin"}static{this.\u0275fac=function(a){return new(a||t)(x(A),x(F),x(D))}}static{this.\u0275cmp=b({type:t,selectors:[["app-equipments"]],standalone:!0,features:[y],decls:12,vars:3,consts:[["noEquipment",""],["elseStatus",""],["pending",""],[1,"content","flex-grow-1","p-4"],[1,"container","mt-4"],["class","alert alert-danger",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"text-primary","fw-bold"],[1,"btn","btn-success",3,"click"],[1,"bi","bi-plus-square"],[4,"ngIf","ngIfElse"],[1,"alert","alert-danger"],[1,"table-responsive","shadow-sm","rounded"],[1,"table","table-striped","table-hover","align-middle"],[1,"table-dark"],["class","text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-center"],["class","badge bg-success",4,"ngIf","ngIfElse"],[1,"badge","bg-success"],["class","badge bg-danger",4,"ngIf","ngIfElse"],[1,"badge","bg-danger"],[1,"badge","bg-warning","text-dark"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"alert","alert-info","mt-4","text-center"]],template:function(a,s){if(a&1){let u=v();n(0,"section",3)(1,"div",4),c(2,O,2,1,"div",5),n(3,"div",6)(4,"h3",7),o(5,"Homologa\xE7\xE3o Sem Parar"),i(),n(6,"button",8),f("click",function(){return _(u),E(s.openCreateEquipmentModal())}),C(7,"i",9),o(8," Novo Equipamento "),i()(),c(9,H,24,2,"div",10)(10,U,2,0,"ng-template",null,0,q),i()()}if(a&2){let u=g(11);r(2),d("ngIf",s.errorMessage),r(7),d("ngIf",s.equipamentos.length>0)("ngIfElse",u)}},dependencies:[V,w,k,R]})}}return t})();export{ee as a};
